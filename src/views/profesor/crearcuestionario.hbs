<!--
<style>
  #sortable { list-style-type: none; margin: 0; padding: 0; width: 60%; }
  #sortable li { margin: 0 3px 3px 3px; padding: 0.4em; padding-left: 1.5em; font-size: 1.4em; height: 18px; }
  #sortable li span { position: absolute; margin-left: -1.3em; }
  </style>
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <script>
  $( function() {
    $( "#sortable, #sortable2" ).sortable({
		connectWith:".connected"
	});
	$( "#sortable, #sortable2" ).disableSelection();
	
  } );
 </script>
-->
<div id="container"  class="section white z-depth-5">
    <div id="quizz" class="quizz">
        <h1>Creación de cuestionario</h1>

        Añade pregunta:
        <div id="btnadd">
            <button id='add' class='btn waves-effect waves-light' onclick='addQuestion()'>Añadir pregunta</button>
        </div>
        <select id="select">
            <option value="1">Pregunta de incisos</option>
            <option value="2">No sé</option>
        </select>
        <div id="preguntas">
            

        </div>
        <!--
        <div class="row container">
            
              <ul id="sortable" class="connected col s6">
                  <li class="ui-state-default">
                      <div class="row">
    <div class="col s6 m6">
      <div class="card blue-grey darken-1">
        <div class="card-content white-text">
          <span class="card-title">Card Title</span>
          <p>I am a very simple card. I am good at containing small bits of information.
          I am convenient because I require little markup to use effectively.</p>
        </div>
        <div class="card-action">
          <a href="#">This is a link</a>
          <a href="#">This is a link</a>
        </div>
      </div>
    </div>
  </div></li>
                <li class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 1</li>
                <li class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 2</li>
                <li class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 3</li>
                <li class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 4</li>
                <li class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 5</li>
                <li class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 6</li>
                <li class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 7</li>
             </ul>
            <ul id="sortable2" class="connected col s6">
                <li class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 1</li>
                <li class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 2</li>
                <li class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 3</li>
                <li class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 4</li>
                <li class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 5</li>
                <li class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 6</li>
                <li class="ui-state-default"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>Item 7</li>
	        </ul>
        </div>   -->    
       
 
        <div class="row container"> 
                                     <button class="btn waves-effect waves-light" type="submit" name="action"
                                                    href="#modalAgregar" id="send">
                                                    <i class="fas fa-edit"></i>
                                                    <a class="modal-trigger btn-flat" href="#modalAgregar">Agregar Temas</a>  
                                     </button>
        </div>
 
        <div id='contenido'></div>

        <div id="send"> 
            <button id='terminar' onclick="finish()">TERMINAR Quizz</button>
        </div>






         </div>
            <div id="modalAgregar" class="modal">
                 <div class="modal-content">
                    <h4>Nuevo Tema</h4>
                    <form action="/registrarAdmin" method="POST" id="registro_admin">
                        <div class="row">
                            <div class="input-field col s6">
                                <input id="tema_mod" name="tema" type="text" class="validate">
                                <label for="tema">Tema</label>
                            </div>
                            
                        </div>
                        <div class="row">
                            <div class="input-field col s12">
                                <select name="tipo_usuario">
                                    <option value="" disabled selected>Escoge tu opción</option>
                                    <option value=1>Alumno</option>
                                    <option value=2>Padre/Tutor</option>
                                </select>
                                <label>Tipo de cuenta</label>
                            </div>
                        </div>
                        
                    
                    <div class="modal-footer">
                        <button type="submit" class="waves-effect waves-green btn-flat">Registrar</button>
                        
                        <a href="#!" class="modal-close waves-effect waves-green btn-flat">Cerrar</a>
                    </div>
                    </form>
            </div>
        <script>
            let numero_preguntas = 0;
            let ajson = [];
            function addQuestion() {
                document.getElementById('btnadd').innerHTML = "";
                numero_preguntas += 1;
                let a = "Ingresa la pregunta: <input type='text' id='pregunta" + numero_preguntas + "'> " +
                    "iniciso a: <input type='text' id='ia" + numero_preguntas + "'>" +
                    "inciso b: <input type='text' id='ib" + numero_preguntas + "'> " +
                    "inciso c: <input type='text' id='ic" + numero_preguntas + "'>" +
                    "inciso d: <input type='text' id='id" + numero_preguntas + "'>" +
                    "Ingresa el tema:<br> <select id='tema'><option value='1'>tema1</option>" +
                    "</select> Ingresa la dificultad: <select id='dificultad'>" +
                    "<option value='1'>Fácil</option><option value='2'>Medio</option><option value='3'>Díficil</option>" +
                    "</select>" +
                    "<button id='ok' class='btn waves-effect waves-light' onclick='seguir()'>Aceptar</button>";
                document.getElementById('preguntas').innerHTML = a;
            }
            function seguir() {
                let json = {}
                let a, b, c, d, p;
                p = document.getElementById('pregunta' + numero_preguntas + '').value;
                a = document.getElementById('ia' + numero_preguntas + '').value;
                b = document.getElementById('ib' + numero_preguntas + '').value;
                c = document.getElementById('ic' + numero_preguntas + '').value;
                d = document.getElementById('id' + numero_preguntas + '').value;
                json = {
                    "numero": numero_preguntas,
                    "p": p,
                    "a": a,
                    "b": b,
                    "c": c,
                    "d": d,
                    "tema":"tema 1",
                    "dificulty":1
                }
                ajson.push(json);
                let Array_content = [numero_preguntas, p, a, b, c, d]
                const btn = "<button id='add' class='btn waves-effect waves-light' onclick='addQuestion()'>Añadir pregunta</button>";
                let add = `<div id='Q${numero_preguntas}'><h3>Pregunta ${numero_preguntas}</h3><br>
                    <button id='delete' class='btn waves-effect waves-light' onclick='borrar(${numero_preguntas})'>Borrar</button>
                    <button id='edit' class='btn waves-effect waves-light' onclick="editar(${numero_preguntas},'${p}','${a}','${b}','${c}','${d}')">Editar</button>
                    <p id='cp${numero_preguntas}'></p>
                    <p id='ca${numero_preguntas}'></p>
                    <p id='cb${numero_preguntas}'></p>
                    <p id='cc${numero_preguntas}'></p>
                    <p id='cd${numero_preguntas}'></p>
                    </div>
             `;
                document.getElementById('preguntas').innerHTML = "";
                document.getElementById('btnadd').innerHTML = btn;
                document.getElementById('contenido').innerHTML += add;


                document.getElementById('cp'+numero_preguntas).textContent=p;
                document.getElementById('ca'+numero_preguntas).innerText=a;
                document.getElementById('cb'+numero_preguntas).innerText=b;
                document.getElementById('cc'+numero_preguntas).innerText=c;
                document.getElementById('cd'+numero_preguntas).innerText=d;
                
            }
            function validarcampos() {

            }
            function borrar(numero) {
                ajson[numero-1]=null;
                document.getElementById('Q' + numero).remove();
            }

            function editar(n, p, a, b, c, d) {
                let html = `Edita la pregunta: <input type='text' id='pregunta${n}' value='${p}'> 
            iniciso a: <input type='text' id='ia${n}' value='${a}'>
            inciso b: <input type='text' id='ib${n}' value='${b}'>
            inciso c: <input type='text' id='ic${n}' value='${c}'>
            inciso d: <input type='text' id='id${n}' value='${d}'> 
            Ingresa el tema: <select id='tema'><option value='1'>tema1</option></select>
            Ingresa la dificultad: <select id='dificultad'>
            <option value='1'>Fácil</option><option value='2'>Medio</option><option value='3'>Díficil</option> 
            </select>
            <button id='oke' class='btn waves-effect waves-light' onclick="editado(${n})">Aceptar</button>`;
                document.getElementById('Q' + n).innerHTML = html;
            }
            function editado(numero) {
                let a, b, c, d, p, json;
                p = document.getElementById('pregunta' + numero + '').value;
                a = document.getElementById('ia' + numero + '').value;
                b = document.getElementById('ib' + numero + '').value;
                c = document.getElementById('ic' + numero + '').value;
                d = document.getElementById('id' + numero + '').value;
                let add = `<div id='Q${numero}'><h3>Pregunta ${numero}</h3><br>
                    <button id='delete' class='btn waves-effect waves-light' onclick='borrar(${numero})'>Borrar</button>
                    <button id='edit' class='btn waves-effect waves-light' onclick="editar(${numero},'${p}','${a}','${b}','${c}','${d}')">Editar</button>
                    <p id='cp${numero}'></p>
                    <p id='ca${numero}'></p>
                    <p id='cb${numero}'></p>
                    <p id='cc${numero}'></p>
                    <p id='cd${numero}'></p></div>
             `;
             json = {
                    "numero": numero_preguntas,
                    "p": p,
                    "a": a,
                    "b": b,
                    "c": c,
                    "d": d,
                    "tema":"tema 1",
                    "dificulty":1
                }
            ajson[numero-1]=json; 
                document.getElementById('Q' + numero).innerHTML = add;
                document.getElementById('cp'+numero_preguntas).textContent=p;
                document.getElementById('ca'+numero_preguntas).innerText=a;
                document.getElementById('cb'+numero_preguntas).innerText=b;
                document.getElementById('cc'+numero_preguntas).innerText=c;
                document.getElementById('cd'+numero_preguntas).innerText=d;
            } 

            function finish(){
                console.log(ajson);
                let param=""; 
                for(let i=0; i<ajson.length;i++){ 
                    console.log(ajson[i])
                    if(ajson!=null){
                        param+=JSON.stringify(ajson[i])+"|";
                    }
                }
                param=param.slice(0, -1);
                

                document.getElementById('btnadd').remove();

                let html="<form action='/Addquestions/"+param+"' method='POST'>"+
                    "<button type='submit' id='aceptar'>Añadir preguntas</button>"+
                    "</form>"
                document.getElementById('send').innerHTML=html; 
            }

        </script>